From 4196fe3cd38f2e0aa7e9fca73d8e0a2c694da102 Mon Sep 17 00:00:00 2001
From: Mohamad Ayyash <mkayyash@google.com>
Date: Tue, 24 May 2016 10:28:30 -0700
Subject: [PATCH] Replace %p with %pK to prevent leaking kernel address

BUG: 27532522
Change-Id: Ic0710a9a8cfc682acd88ecf3bbfeece2d798c4a4
Signed-off-by: Mohamad Ayyash <mkayyash@google.com>
(cherry picked from commit 8694d6b0717606643757fbc8dfec2ff3dd2e62e6)
---

diff --git a/net/netfilter/xt_qtaguid.c b/net/netfilter/xt_qtaguid.c
index e3c7c51..43a07e8 100644
--- a/net/netfilter/xt_qtaguid.c
+++ b/net/netfilter/xt_qtaguid.c
@@ -1979,7 +1979,7 @@
 		f_count = atomic_long_read(
 			&sock_tag_entry->socket->file->f_count);
 		len = snprintf(outp, char_count,
-			       "sock=%p tag=0x%llx (uid=%u) pid=%u "
+			       "sock=%pK tag=0x%llx (uid=%u) pid=%u "
 			       "f_count=%lu\n",
 			       sock_tag_entry->sk,
 			       sock_tag_entry->tag, uid,
